# ê´€ë¦¬ì CLI ì‹¤ì œ ì‚¬ìš© ê°€ì´ë“œ

## ğŸ“‹ ì‹¤ì œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤: ê³ ê°ì´ ë³´ì¦ì„œ ì–‘ë„ë¥¼ ìš”ì²­í•œ ê²½ìš°

**ìƒí™©:**
- ê³ ê°: `minmi199942@gmail.com`
- ì œí’ˆ: "ì†”ë¦¬ë“œ ìˆ˜íŠ¸ ìŠ¬ë¦¼ íƒ€ì´"
- ìš”ì²­: `sale_luxury@naver.com`ìœ¼ë¡œ ë³´ì¦ì„œ ì–‘ë„

**ë¬¸ì œ:** ì–´ë–¤ í† í°ì¸ì§€ ëª¨ë¦„

---

## ğŸ” í•´ê²° ë°©ë²•: 3ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤

### 1ë‹¨ê³„: í† í° ì°¾ê¸° (ê²€ìƒ‰)

ê³ ê° ì´ë©”ì¼ ë˜ëŠ” ì œí’ˆëª…ìœ¼ë¡œ ê²€ìƒ‰:

```bash
cd /var/www/html/backend

# ë°©ë²• 1: ì´ë©”ì¼ë¡œ ê²€ìƒ‰ (ê³ ê°ì´ ì†Œìœ í•œ ëª¨ë“  í† í° ì¡°íšŒ)
npm run admin -- token:search --term=minmi199942@gmail.com
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
ğŸ“‹ ê²€ìƒ‰ ê²°ê³¼ (2ê°œ, ìµœëŒ€ 50ê°œ):

1. í† í°: ExMbJtsimix287HBHu3I
   ì œí’ˆëª…: ì†”ë¦¬ë“œ ìˆ˜íŠ¸ ìŠ¬ë¦¼ íƒ€ì´
   ë‚´ë¶€ì½”ë“œ: ACC26FabricTieBKSkinny00001
   ìƒíƒœ: ì •ìƒ
   ìŠ¤ìº”íšŸìˆ˜: 1íšŒ
   ì†Œìœ ì£¼: minmi199942@gmail.com
   ìµœì¢… ìŠ¤ìº”: 2025-12-31 15:40 (KST)

2. í† í°: Wu34wbf5N7GycYkYQp99
   ì œí’ˆëª…: í…Œë‰´ ì†”ë¦¬ë“œ ì…”ì¸ 
   ë‚´ë¶€ì½”ë“œ: SH26TeneuSolidLBL00001
   ìƒíƒœ: ì •ìƒ
   ìŠ¤ìº”íšŸìˆ˜: 3íšŒ
   ì†Œìœ ì£¼: minmi199942@gmail.com
   ìµœì¢… ìŠ¤ìº”: 2025-12-31 16:00 (KST)
```

**ë˜ëŠ” ì œí’ˆëª…ìœ¼ë¡œ ê²€ìƒ‰:**
```bash
npm run admin -- token:search --term=ì†”ë¦¬ë“œ ìˆ˜íŠ¸ ìŠ¬ë¦¼ íƒ€ì´
```

---

### 2ë‹¨ê³„: í† í° ìƒì„¸ í™•ì¸ (ê²€ì¦)

ì°¾ì€ í† í°ì˜ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•˜ì—¬ ì •í™•í•œ í† í°ì¸ì§€ ê²€ì¦:

```bash
npm run admin -- token:lookup --token=ExMbJtsimix287HBHu3I
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
ğŸ“‹ í† í° ì •ë³´:
   í† í°: ExMbJtsimix287HBHu3I
   ì œí’ˆëª…: ì†”ë¦¬ë“œ ìˆ˜íŠ¸ ìŠ¬ë¦¼ íƒ€ì´
   ë‚´ë¶€ì½”ë“œ: ACC26FabricTieBKSkinny00001
   ì°¨ë‹¨ì—¬ë¶€: ì •ìƒ
   ìŠ¤ìº”íšŸìˆ˜: 1íšŒ
   ìµœì´ˆ ìŠ¤ìº”: 2025-12-31 15:40 (KST)
   ìµœì¢… ìŠ¤ìº”: 2025-12-31 15:40 (KST)

ğŸ‘¤ ì†Œìœ ì£¼ ì •ë³´:
   user_id: 5
   ì´ë©”ì¼: minmi199942@gmail.com
   ì´ë¦„: í™ê¸¸ë™

ğŸ“„ ë³´ì¦ì„œ ì •ë³´:
   public_id: abc123-def456-...
   ìƒì„±ì¼: 2025-12-31 15:40 (KST)
   ì¸ì¦ì¼: 2025-12-31 15:40 (KST)
```

**í™•ì¸ ì‚¬í•­:**
- âœ… ì œí’ˆëª…ì´ "ì†”ë¦¬ë“œ ìˆ˜íŠ¸ ìŠ¬ë¦¼ íƒ€ì´"ì¸ì§€ í™•ì¸
- âœ… í˜„ì¬ ì†Œìœ ì£¼ê°€ `minmi199942@gmail.com`ì¸ì§€ í™•ì¸
- âœ… ë³´ì¦ì„œê°€ ì •ìƒì¸ì§€ í™•ì¸ (ì°¨ë‹¨ ì—¬ë¶€)

---

### 3ë‹¨ê³„: ì–‘ë„ ì‹¤í–‰ (dry-run â†’ ì‹¤ì œ ì‹¤í–‰)

#### 3-1. ë¯¸ë¦¬ë³´ê¸° (dry-run) - í•„ìˆ˜!

**ì‹¤ìˆ˜ ë°©ì§€ë¥¼ ìœ„í•´ ë°˜ë“œì‹œ dry-run ë¨¼ì € ì‹¤í–‰:**

```bash
npm run admin -- warranty:transfer \
  --token=ExMbJtsimix287HBHu3I \
  --from=minmi199942@gmail.com \
  --to=sale_luxury@naver.com \
  --reason="ê³ ê° ìš”ì²­: ì„ ë¬¼ìš© ì–‘ë„" \
  --dry-run
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
ğŸ“‹ ì–‘ë„ ì •ë³´:
   í† í°: ExMbJtsimix287HBHu3I
   í˜„ì¬ ì†Œìœ ì£¼: minmi199942@gmail.com (user_id: 5)
   ìƒˆ ì†Œìœ ì£¼: sale_luxury@naver.com (user_id: 12)
   ê´€ë¦¬ì: dmsals0603@naver.com (user_id: 1)

ğŸ” [DRY-RUN] ë‹¤ìŒ ì‘ì—…ì´ ì‹¤í–‰ë  ì˜ˆì •ì…ë‹ˆë‹¤:
   1. warranties.user_id: 5 â†’ 12 (ì˜ˆìƒ affectedRows: 1)
   2. token_master.owner_user_id: 5 â†’ 12 (ì˜ˆìƒ affectedRows: 1)
   3. transfer_logs ê¸°ë¡ ì¶”ê°€ (ì˜ˆìƒ: 1ê±´)

âš ï¸  ì‹¤ì œë¡œëŠ” ë³€ê²½ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. (--dry-run ëª¨ë“œ)

ğŸ’¡ ì°¸ê³ : affectedRowsê°€ 0ì´ë©´ ì†Œìœ ì£¼ê°€ ì¼ì¹˜í•˜ì§€ ì•Šê±°ë‚˜ ì´ë¯¸ ë³€ê²½ë˜ì—ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```

**í™•ì¸ ì‚¬í•­:**
- âœ… í˜„ì¬ ì†Œìœ ì£¼ê°€ ë§ëŠ”ì§€ í™•ì¸
- âœ… ìƒˆ ì†Œìœ ì£¼ê°€ ë§ëŠ”ì§€ í™•ì¸
- âœ… ì˜ˆìƒ affectedRowsê°€ 1ì¸ì§€ í™•ì¸ (0ì´ë©´ ë¬¸ì œ ìˆìŒ)

#### 3-2. ì‹¤ì œ ì‹¤í–‰

dry-run ê²°ê³¼ê°€ ì •ìƒì´ë©´ ì‹¤ì œ ì‹¤í–‰:

```bash
npm run admin -- warranty:transfer \
  --token=ExMbJtsimix287HBHu3I \
  --from=minmi199942@gmail.com \
  --to=sale_luxury@naver.com \
  --reason="ê³ ê° ìš”ì²­: ì„ ë¬¼ìš© ì–‘ë„"
```

**í™•ì¸ í”„ë¡¬í”„íŠ¸:**
```
âš ï¸  ì •ë§ ì–‘ë„í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (yes/no): 
```

`yes` ì…ë ¥ í›„ ì‹¤í–‰:

**ì¶œë ¥ ì˜ˆì‹œ:**
```
âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ:
   warranties.affectedRows: 1
   token_master.affectedRows: 1

âœ… ë³´ì¦ì„œ ì–‘ë„ ì™„ë£Œ: ExMbJtsimix287HBHu3I (minmi199942@gmail.com â†’ sale_luxury@naver.com)
```

---

## ğŸ“Š ì „ì²´ í”„ë¡œì„¸ìŠ¤ ìš”ì•½

```
1. ê²€ìƒ‰ (token:search)
   â†“
2. í™•ì¸ (token:lookup)
   â†“
3. ë¯¸ë¦¬ë³´ê¸° (warranty:transfer --dry-run)
   â†“
4. ì‹¤ì œ ì‹¤í–‰ (warranty:transfer)
```

---

## ğŸš¨ ì£¼ì˜ì‚¬í•­

### 1. í•­ìƒ dry-run ë¨¼ì €
- ì‹¤ìˆ˜ ë°©ì§€ë¥¼ ìœ„í•´ ë°˜ë“œì‹œ `--dry-run` ì˜µì…˜ìœ¼ë¡œ ë¨¼ì € í™•ì¸
- affectedRowsê°€ 0ì´ë©´ ì¦‰ì‹œ ì¤‘ë‹¨í•˜ê³  ì›ì¸ í™•ì¸

### 2. ì†Œìœ ì£¼ í™•ì¸ í•„ìˆ˜
- `--from` ì´ë©”ì¼ì´ í˜„ì¬ ì†Œìœ ì£¼ì™€ ì •í™•íˆ ì¼ì¹˜í•´ì•¼ í•¨
- ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´ ì–‘ë„ ì‹¤íŒ¨

### 3. ìƒˆ ì†Œìœ ì£¼ ê³„ì • í™•ì¸
- `--to` ì´ë©”ì¼ì´ ì‹œìŠ¤í…œì— ë“±ë¡ëœ ê³„ì •ì´ì–´ì•¼ í•¨
- ì—†ìœ¼ë©´ ì—ëŸ¬ ë°œìƒ

### 4. ì–‘ë„ ì‚¬ìœ  ê¸°ë¡
- `--reason` ì˜µì…˜ìœ¼ë¡œ ì–‘ë„ ì‚¬ìœ ë¥¼ ê¸°ë¡ (ê°ì‚¬ ëª©ì )
- ì˜ˆ: "ê³ ê° ìš”ì²­: ì„ ë¬¼ìš© ì–‘ë„", "CS ìš”ì²­: ê³„ì • ë³€ê²½"

---

## ğŸ’¡ ì¶”ê°€ íŒ

### ì—¬ëŸ¬ ê°œ í† í° ì–‘ë„ (ì¼ê´„ ì²˜ë¦¬)

CSV íŒŒì¼ë¡œ ì¼ê´„ ì–‘ë„ ê°€ëŠ¥:

```bash
# CSV íŒŒì¼ ìƒì„±
cat > transfers.csv << 'EOF'
token,from,to,reason
ExMbJtsimix287HBHu3I,minmi199942@gmail.com,sale_luxury@naver.com,ê³ ê° ìš”ì²­ ì„ ë¬¼ìš©
Wu34wbf5N7GycYkYQp99,minmi199942@gmail.com,another@email.com,ê³ ê° ìš”ì²­ ì„ ë¬¼ìš©
EOF

# ë¯¸ë¦¬ë³´ê¸°
npm run admin -- warranty:transfer-batch --file=transfers.csv --dry-run

# ì‹¤ì œ ì‹¤í–‰
npm run admin -- warranty:transfer-batch --file=transfers.csv
```

### í† í° ì°¨ë‹¨ (ê°€í’ˆ/ë¶„ì‹¤ ë“±)

```bash
# ì°¨ë‹¨ ë¯¸ë¦¬ë³´ê¸°
npm run admin -- token:block --token=ExMbJtsimix287HBHu3I --reason="ê³ ê° ì‹ ê³ : ê°€í’ˆ ì˜ì‹¬" --dry-run

# ì‹¤ì œ ì°¨ë‹¨
npm run admin -- token:block --token=ExMbJtsimix287HBHu3I --reason="ê³ ê° ì‹ ê³ : ê°€í’ˆ ì˜ì‹¬"
```

### ë³´ì¦ì„œ ì‚­ì œ (soft delete)

```bash
# ì‚­ì œ ë¯¸ë¦¬ë³´ê¸°
npm run admin -- warranty:delete --token=ExMbJtsimix287HBHu3I --reason="ê³ ê° ìš”ì²­: ë³´ì¦ì„œ ì‚­ì œ" --dry-run

# ì‹¤ì œ ì‚­ì œ
npm run admin -- warranty:delete --token=ExMbJtsimix287HBHu3I --reason="ê³ ê° ìš”ì²­: ë³´ì¦ì„œ ì‚­ì œ"
```

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

ì–‘ë„ ì „ í™•ì¸ ì‚¬í•­:
- [ ] ê³ ê° ì´ë©”ì¼ë¡œ í† í° ê²€ìƒ‰ ì™„ë£Œ
- [ ] í† í° ìƒì„¸ ì •ë³´ í™•ì¸ ì™„ë£Œ (ì œí’ˆëª…, ì†Œìœ ì£¼ ì¼ì¹˜)
- [ ] dry-runìœ¼ë¡œ ë¯¸ë¦¬ë³´ê¸° ì™„ë£Œ
- [ ] affectedRowsê°€ 1ì¸ì§€ í™•ì¸
- [ ] ìƒˆ ì†Œìœ ì£¼ ì´ë©”ì¼ì´ ì‹œìŠ¤í…œì— ë“±ë¡ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
- [ ] ì–‘ë„ ì‚¬ìœ  ê¸°ë¡

