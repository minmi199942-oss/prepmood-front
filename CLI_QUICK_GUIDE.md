# ê´€ë¦¬ì CLI ë¹ ë¥¸ ì‚¬ìš© ê°€ì´ë“œ

## ğŸš€ ì‹œì‘í•˜ê¸°

```bash
cd /var/www/html/backend
npm run admin -- [ëª…ë ¹ì–´]
```

---

## ğŸ“‹ ìì£¼ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´

### 1. í† í° ì°¾ê¸° (ê°€ì¥ ì¤‘ìš”!)

**ê³ ê°ì´ "ì–´ë–¤ í† í°ì¸ì§€ ëª¨ë¥´ê² ë‹¤"ê³  í•  ë•Œ:**

```bash
# ë°©ë²• 1: ê³ ê° ì´ë©”ì¼ë¡œ ê²€ìƒ‰ (ê°€ì¥ ë§ì´ ì‚¬ìš©)
npm run admin -- token:search --term=ê³ ê°ì´ë©”ì¼@example.com

# ë°©ë²• 2: ì œí’ˆëª…ìœ¼ë¡œ ê²€ìƒ‰
npm run admin -- token:search --term=ì†”ë¦¬ë“œ ìˆ˜íŠ¸ ìŠ¬ë¦¼ íƒ€ì´

# ë°©ë²• 3: ë‚´ë¶€ì½”ë“œë¡œ ê²€ìƒ‰
npm run admin -- token:search --term=ACC26FabricTieBKSkinny00001
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
ğŸ“‹ ê²€ìƒ‰ ê²°ê³¼ (2ê°œ, ìµœëŒ€ 50ê°œ):

1. í† í°: ExMbJtsimix287HBHu3I
   ì œí’ˆëª…: ì†”ë¦¬ë“œ ìˆ˜íŠ¸ ìŠ¬ë¦¼ íƒ€ì´
   ë‚´ë¶€ì½”ë“œ: ACC26FabricTieBKSkinny00001
   ìƒíƒœ: ì •ìƒ
   ìŠ¤ìº”íšŸìˆ˜: 1íšŒ
   ì†Œìœ ì£¼: minmi199942@gmail.com
   ìµœì¢… ìŠ¤ìº”: 2025-12-31 15:40 (KST)
```

---

### 2. í† í° ìƒì„¸ í™•ì¸

**í† í°ì„ ì°¾ì•˜ìœ¼ë©´ ìƒì„¸ ì •ë³´ í™•ì¸:**

```bash
npm run admin -- token:lookup --token=ExMbJtsimix287HBHu3I
```

**í™•ì¸ ì‚¬í•­:**
- âœ… ì œí’ˆëª…ì´ ë§ëŠ”ì§€
- âœ… í˜„ì¬ ì†Œìœ ì£¼ê°€ ë§ëŠ”ì§€
- âœ… `token_master`ì™€ `warranties` ì†Œìœ ì£¼ê°€ ì¼ì¹˜í•˜ëŠ”ì§€ (âš ï¸ ê²½ê³  í‘œì‹œë¨)

---

### 3. ë³´ì¦ì„œ ì–‘ë„ (ê°€ì¥ ë§ì´ ì‚¬ìš©)

#### 3-1. ë¯¸ë¦¬ë³´ê¸° (í•„ìˆ˜! ì‹¤ìˆ˜ ë°©ì§€)

```bash
npm run admin -- warranty:transfer \
  --token=ExMbJtsimix287HBHu3I \
  --from=í˜„ì¬ì†Œìœ ì£¼@email.com \
  --to=ìƒˆì†Œìœ ì£¼@email.com \
  --reason="ê³ ê° ìš”ì²­: ì„ ë¬¼ìš© ì–‘ë„" \
  --dry-run
```

**í™•ì¸ ì‚¬í•­:**
- âœ… í˜„ì¬ ì†Œìœ ì£¼ê°€ ë§ëŠ”ì§€
- âœ… ìƒˆ ì†Œìœ ì£¼ê°€ ë§ëŠ”ì§€
- âœ… ì˜ˆìƒ `affectedRows`ê°€ 1ì¸ì§€ (0ì´ë©´ ë¬¸ì œ!)

#### 3-2. ì‹¤ì œ ì‹¤í–‰

```bash
npm run admin -- warranty:transfer \
  --token=ExMbJtsimix287HBHu3I \
  --from=í˜„ì¬ì†Œìœ ì£¼@email.com \
  --to=ìƒˆì†Œìœ ì£¼@email.com \
  --reason="ê³ ê° ìš”ì²­: ì„ ë¬¼ìš© ì–‘ë„"
```

**í™•ì¸ í”„ë¡¬í”„íŠ¸:**
```
âš ï¸  ì •ë§ ì–‘ë„í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (yes/no): yes
```

**ì„±ê³µ ì¶œë ¥:**
```
âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ:
   warranties.affectedRows: 1
   token_master.affectedRows: 1

âœ… ë³´ì¦ì„œ ì–‘ë„ ì™„ë£Œ: ExMbJtsimix287HBHu3I (í˜„ì¬ì†Œìœ ì£¼@email.com â†’ ìƒˆì†Œìœ ì£¼@email.com)
```

---

### 4. í† í° ì°¨ë‹¨ (ê°€í’ˆ/ë¶„ì‹¤ ì‹ ê³ )

```bash
# ë¯¸ë¦¬ë³´ê¸°
npm run admin -- token:block --token=ExMbJtsimix287HBHu3I --reason="ê³ ê° ì‹ ê³ : ê°€í’ˆ ì˜ì‹¬" --dry-run

# ì‹¤ì œ ì°¨ë‹¨
npm run admin -- token:block --token=ExMbJtsimix287HBHu3I --reason="ê³ ê° ì‹ ê³ : ê°€í’ˆ ì˜ì‹¬"
```

**ì°¨ë‹¨ í›„:**
- í•´ë‹¹ í† í°ìœ¼ë¡œ QR ìŠ¤ìº” ì‹œ "ê°€í’ˆ ê²½ê³ " í˜ì´ì§€ í‘œì‹œ
- ë³´ì¦ì„œëŠ” ìœ ì§€ (soft delete ì•„ë‹˜)

---

### 5. í† í° ì°¨ë‹¨ í•´ì œ

```bash
npm run admin -- token:unblock --token=ExMbJtsimix287HBHu3I
```

---

### 6. ë³´ì¦ì„œ ì‚­ì œ (soft delete)

**ê³ ê°ì´ ë³´ì¦ì„œ ì‚­ì œë¥¼ ìš”ì²­í•œ ê²½ìš°:**

```bash
# ë¯¸ë¦¬ë³´ê¸°
npm run admin -- warranty:delete --token=ExMbJtsimix287HBHu3I --reason="ê³ ê° ìš”ì²­: ë³´ì¦ì„œ ì‚­ì œ" --dry-run

# ì‹¤ì œ ì‚­ì œ
npm run admin -- warranty:delete --token=ExMbJtsimix287HBHu3I --reason="ê³ ê° ìš”ì²­: ë³´ì¦ì„œ ì‚­ì œ"
```

**ì‚­ì œ í›„:**
- ê³ ê° í™”ë©´ì—ì„œ ë³´ì¦ì„œê°€ ì‚¬ë¼ì§
- DBì—ëŠ” `deleted_at`ìœ¼ë¡œ ê¸°ë¡ë¨ (ë³µêµ¬ ê°€ëŠ¥)
- í† í°ì€ ìë™ìœ¼ë¡œ ì°¨ë‹¨ë¨ (`is_blocked = 1`)

---

## ğŸ”„ ì‹¤ì œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ê³ ê°ì´ ë³´ì¦ì„œ ì–‘ë„ë¥¼ ìš”ì²­

**ìƒí™©:**
- ê³ ê°: `minmi199942@gmail.com`
- ì œí’ˆ: "ì†”ë¦¬ë“œ ìˆ˜íŠ¸ ìŠ¬ë¦¼ íƒ€ì´"
- ìš”ì²­: `sale_luxury@naver.com`ìœ¼ë¡œ ì–‘ë„

**ë‹¨ê³„ë³„ ì‹¤í–‰:**

```bash
# 1ë‹¨ê³„: í† í° ì°¾ê¸°
npm run admin -- token:search --term=minmi199942@gmail.com

# ì¶œë ¥ì—ì„œ "ì†”ë¦¬ë“œ ìˆ˜íŠ¸ ìŠ¬ë¦¼ íƒ€ì´" í† í° ì°¾ê¸°
# ì˜ˆ: í† í°: ExMbJtsimix287HBHu3I

# 2ë‹¨ê³„: í† í° í™•ì¸
npm run admin -- token:lookup --token=ExMbJtsimix287HBHu3I

# 3ë‹¨ê³„: ì–‘ë„ ë¯¸ë¦¬ë³´ê¸°
npm run admin -- warranty:transfer \
  --token=ExMbJtsimix287HBHu3I \
  --from=minmi199942@gmail.com \
  --to=sale_luxury@naver.com \
  --reason="ê³ ê° ìš”ì²­: ì„ ë¬¼ìš© ì–‘ë„" \
  --dry-run

# 4ë‹¨ê³„: ì‹¤ì œ ì–‘ë„
npm run admin -- warranty:transfer \
  --token=ExMbJtsimix287HBHu3I \
  --from=minmi199942@gmail.com \
  --to=sale_luxury@naver.com \
  --reason="ê³ ê° ìš”ì²­: ì„ ë¬¼ìš© ì–‘ë„"
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: ê³ ê°ì´ ê°€í’ˆ ì‹ ê³ 

**ìƒí™©:**
- ê³ ê°ì´ "ì´ ì œí’ˆì´ ê°€í’ˆ ê°™ë‹¤"ê³  ì‹ ê³ 
- í† í°: `ExMbJtsimix287HBHu3I`

**ë‹¨ê³„ë³„ ì‹¤í–‰:**

```bash
# 1ë‹¨ê³„: í† í° í™•ì¸
npm run admin -- token:lookup --token=ExMbJtsimix287HBHu3I

# 2ë‹¨ê³„: ì°¨ë‹¨ ë¯¸ë¦¬ë³´ê¸°
npm run admin -- token:block --token=ExMbJtsimix287HBHu3I --reason="ê³ ê° ì‹ ê³ : ê°€í’ˆ ì˜ì‹¬" --dry-run

# 3ë‹¨ê³„: ì‹¤ì œ ì°¨ë‹¨
npm run admin -- token:block --token=ExMbJtsimix287HBHu3I --reason="ê³ ê° ì‹ ê³ : ê°€í’ˆ ì˜ì‹¬"
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 3: ì—¬ëŸ¬ ê°œ í† í° ì¼ê´„ ì–‘ë„ (CSV)

**ìƒí™©:**
- ì—¬ëŸ¬ ê°œ í† í°ì„ í•œ ë²ˆì— ì–‘ë„í•´ì•¼ í•¨

**ë‹¨ê³„ë³„ ì‹¤í–‰:**

```bash
# 1ë‹¨ê³„: CSV íŒŒì¼ ìƒì„±
cat > transfers.csv << 'EOF'
token,from,to,reason
ExMbJtsimix287HBHu3I,minmi199942@gmail.com,sale_luxury@naver.com,ê³ ê° ìš”ì²­ ì„ ë¬¼ìš©
Wu34wbf5N7GycYkYQp99,minmi199942@gmail.com,another@email.com,ê³ ê° ìš”ì²­ ì„ ë¬¼ìš©
EOF

# 2ë‹¨ê³„: ë¯¸ë¦¬ë³´ê¸°
npm run admin -- warranty:transfer-batch --file=transfers.csv --dry-run

# 3ë‹¨ê³„: ì‹¤ì œ ì‹¤í–‰
npm run admin -- warranty:transfer-batch --file=transfers.csv
```

**CSV ê·œì¹™:**
- í—¤ë”: `token,from,to,reason`
- ì¸ì½”ë”©: UTF-8 (BOM ìë™ ì œê±°ë¨)
- `reason` í•„ë“œì— ì½¤ë§ˆ(,) ì‚¬ìš© ê¸ˆì§€

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. í•­ìƒ dry-run ë¨¼ì €!
- ì‹¤ìˆ˜ ë°©ì§€ë¥¼ ìœ„í•´ ë°˜ë“œì‹œ `--dry-run` ì˜µì…˜ìœ¼ë¡œ ë¨¼ì € í™•ì¸
- `affectedRows`ê°€ 0ì´ë©´ ì¦‰ì‹œ ì¤‘ë‹¨í•˜ê³  ì›ì¸ í™•ì¸

### 2. ì†Œìœ ì£¼ í™•ì¸ í•„ìˆ˜
- `--from` ì´ë©”ì¼ì´ í˜„ì¬ ì†Œìœ ì£¼ì™€ ì •í™•íˆ ì¼ì¹˜í•´ì•¼ í•¨
- ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´ ì–‘ë„ ì‹¤íŒ¨

### 3. ìƒˆ ì†Œìœ ì£¼ ê³„ì • í™•ì¸
- `--to` ì´ë©”ì¼ì´ ì‹œìŠ¤í…œì— ë“±ë¡ëœ ê³„ì •ì´ì–´ì•¼ í•¨
- ì—†ìœ¼ë©´ ì—ëŸ¬ ë°œìƒ

### 4. ì–‘ë„ ì‚¬ìœ  ê¸°ë¡
- `--reason` ì˜µì…˜ìœ¼ë¡œ ì–‘ë„ ì‚¬ìœ ë¥¼ ê¸°ë¡ (ê°ì‚¬ ëª©ì )
- ì˜ˆ: "ê³ ê° ìš”ì²­: ì„ ë¬¼ìš© ì–‘ë„", "CS ìš”ì²­: ê³„ì • ë³€ê²½"

---

## ğŸš¨ ì—ëŸ¬ í•´ê²°

### "ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
- ì´ë©”ì¼ ì£¼ì†Œ í™•ì¸
- ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ìŒ (ìë™ ì†Œë¬¸ì ë³€í™˜)

### "í† í°ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
- í† í° ì •í™•íˆ ì…ë ¥í–ˆëŠ”ì§€ í™•ì¸
- `token:search`ë¡œ ë¨¼ì € ê²€ìƒ‰

### "ì†Œìœ ì£¼ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"
- `--from` ì´ë©”ì¼ì´ í˜„ì¬ ì†Œìœ ì£¼ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
- `token:lookup`ìœ¼ë¡œ í˜„ì¬ ì†Œìœ ì£¼ í™•ì¸

### "affectedRowsê°€ 0"
- ì†Œìœ ì£¼ê°€ ì´ë¯¸ ë³€ê²½ë˜ì—ˆì„ ìˆ˜ ìˆìŒ
- `token:lookup`ìœ¼ë¡œ í˜„ì¬ ìƒíƒœ í™•ì¸

---

## ğŸ’¡ íŒ

### ë¹ ë¥¸ ê²€ìƒ‰
```bash
# ì´ë©”ì¼ë¡œ ê²€ìƒ‰ (ê°€ì¥ ë¹ ë¦„)
npm run admin -- token:search --term=ê³ ê°ì´ë©”ì¼@example.com

# ì œí’ˆëª…ìœ¼ë¡œ ê²€ìƒ‰
npm run admin -- token:search --term=ì œí’ˆëª…
```

### ìë™í™” (ë¬´ì¸ ì‹¤í–‰)
```bash
# --yes ì˜µì…˜ìœ¼ë¡œ í™•ì¸ í”„ë¡¬í”„íŠ¸ ê±´ë„ˆë›°ê¸°
npm run admin -- warranty:transfer \
  --token=TOKEN \
  --from=FROM \
  --to=TO \
  --yes
```

**ì£¼ì˜:** ìë™í™”ê°€ ì•„ë‹Œ ì´ìƒ `--yes` ì‚¬ìš© ê¸ˆì§€!

---

## ğŸ“Š ì „ì²´ í”„ë¡œì„¸ìŠ¤ ìš”ì•½

```
1. ê²€ìƒ‰ (token:search)
   â†“
2. í™•ì¸ (token:lookup)
   â†“
3. ë¯¸ë¦¬ë³´ê¸° (--dry-run)
   â†“
4. ì‹¤ì œ ì‹¤í–‰
```

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

ì–‘ë„ ì „ í™•ì¸:
- [ ] ê³ ê° ì´ë©”ì¼ë¡œ í† í° ê²€ìƒ‰ ì™„ë£Œ
- [ ] í† í° ìƒì„¸ ì •ë³´ í™•ì¸ ì™„ë£Œ (ì œí’ˆëª…, ì†Œìœ ì£¼ ì¼ì¹˜)
- [ ] dry-runìœ¼ë¡œ ë¯¸ë¦¬ë³´ê¸° ì™„ë£Œ
- [ ] affectedRowsê°€ 1ì¸ì§€ í™•ì¸
- [ ] ìƒˆ ì†Œìœ ì£¼ ì´ë©”ì¼ì´ ì‹œìŠ¤í…œì— ë“±ë¡ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
- [ ] ì–‘ë„ ì‚¬ìœ  ê¸°ë¡


