<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>디지털 인보이스 - Pre.p Mood</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonts-archive/Paperlogy/Paperlogy.css" type="text/css"/>
    <link rel="stylesheet" href="/assets/css/global.css">
    <link rel="stylesheet" href="/assets/css/layout-system.css">
    <link rel="stylesheet" href="/assets/css/header.css">
    <link rel="stylesheet" href="/assets/css/page.css">
    <link rel="stylesheet" href="/assets/css/responsive.css">
    <style>
        /* ============================================
           폰트 정의
           ============================================ */
        @font-face {
            font-family: 'Paperlogy';
            src: url('/static/fonts/Paperlogy-4Regular.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: 'Paperlogy';
            src: url('/static/fonts/Paperlogy-5Medium.ttf') format('truetype');
            font-weight: 500;
            font-style: normal;
            font-display: swap;
        }

        /* ============================================
           편지 카드 사이즈 조정 변수
           이 섹션의 값만 변경하면 전체 편지 크기가 조정됩니다
           ============================================ */
        :root {
            /* === 카드 기본 크기 === */
            /* 원본 Figma: 492.7px × 703.9px (비율 1.428) */
            /* 조정된 비율: 1.0 (정사각형에 가까운 비율) */
            --card-aspect-ratio: 1.0;
            --card-width: 650px;
            --card-height: calc(var(--card-width) * var(--card-aspect-ratio));
            
            /* === 봉투 본체 높이 === */
            --envelope-body-height: 320px;
            
            /* === 뚜껑 높이 === */
            --envelope-flap-height: 200px;
            
            /* === 편지 내용 영역 높이 (hover 시) === */
            --letter-content-height: 180px;
            
            /* === 씰 위치 조정 === */
            --seal-bottom-bottom: 280px;
            --seal-bottom-left: 50%;
            --seal-bottom-translate-x: -50%;
            --seal-top-bottom: 375px;
            --seal-top-left: 50%;
            --seal-top-translate-x: -50%;
            
            /* === 그레이 레이어 (씰 연결선) === */
            --greylayer-bottom: 280px;
            --greylayer-left: 50%;
            --greylayer-translate-x: -50%;
            --greylayer-width: 60px;
            --greylayer-height: 153px;
            
            /* === 호버 애니메이션 이동 거리 === */
            --hover-lift-distance: 180px;
        }

        /* ============================================
           편지 카드 디자인 스타일
           ============================================ */
        .invoice-letter-card {
            position: relative;
            cursor: pointer;
            width: var(--card-width);
            margin-bottom: 40px;
        }

        .invoice-letter-card-wrapper {
            position: relative;
            height: var(--card-height);
        }

        /* 하단 고정 - 회색 봉투 본체 */
        .invoice-envelope-body {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--envelope-body-height);
            background-color: rgba(230, 230, 230, 1);
            box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.5);
            z-index: 10;
        }

        .invoice-envelope-brand {
            position: absolute;
            top: 80px;
            left: 0;
            right: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0 32px;
        }

        .invoice-envelope-logo {
            max-width: 200px;
            max-height: 120px;
            width: auto;
            height: auto;
            object-fit: contain;
            margin-bottom: 16px;
        }

        .invoice-envelope-logo-secondary {
            max-width: 150px;
            max-height: 80px;
            width: auto;
            height: auto;
            object-fit: contain;
        }

        /* 하단 씰 */
        .invoice-seal-bottom {
            position: absolute;
            left: var(--seal-bottom-left, 50%);
            transform: translateX(var(--seal-bottom-translate-x, -50%));
            bottom: var(--seal-bottom-bottom, 280px);
            z-index: 35;
            opacity: 1;
            transition: opacity 700ms ease-out;
        }

        .invoice-letter-card:hover .invoice-seal-bottom {
            opacity: 0; /* 페이드아웃만 (올라가지 않음) */
        }

        .invoice-seal-bottom-circle {
            width: 50px;
            height: 50px;
            object-fit: contain;
        }

        /* 그레이 레이어 (상단 씰과 하단 씰을 이어주는 레이어) */
        .invoice-greylayer {
            position: absolute;
            left: var(--greylayer-left, 50%);
            transform: translateX(var(--greylayer-translate-x, -50%));
            bottom: var(--greylayer-bottom, 280px); /* 하단 고정 */
            top: auto;
            z-index: 30;
            width: var(--greylayer-width, 50px);
            height: var(--greylayer-height, 140px); /* 컨테이너 높이 명시 */
            display: flex;
            align-items: flex-end; /* 하단 기준으로 정렬 */
            justify-content: center;
            overflow: visible; /* 위로 넘어가도 보이도록 */
            opacity: 1;
            transition: bottom 700ms ease-out, opacity 700ms ease-out;
        }

        .invoice-letter-card:hover .invoice-greylayer {
            bottom: calc(var(--greylayer-bottom) + var(--hover-lift-distance)); /* 올라가면서 */
            opacity: 0; /* 사라짐 */
        }

        .invoice-greylayer-img {
            width: var(--greylayer-width, 50px);
            height: var(--greylayer-height, 140px); /* SVG 높이를 직접 제어 */
            display: block;
            transform-origin: bottom center; /* 하단 기준으로 늘어나도록 */
            flex-shrink: 0; /* flex에서 축소 방지 */
        }

        /* 상단 씰 */
        .invoice-seal-top {
            position: absolute;
            left: var(--seal-top-left, 50%);
            transform: translateX(var(--seal-top-translate-x, -50%));
            bottom: var(--seal-top-bottom, 420px);
            z-index: 35;
            opacity: 1;
            transition: bottom 700ms ease-out, opacity 700ms ease-out;
        }

        .invoice-letter-card:hover .invoice-seal-top {
            bottom: calc(var(--seal-top-bottom) + var(--hover-lift-distance)); /* 올라가면서 */
            opacity: 0; /* 사라짐 */
        }

        .invoice-seal-top-circle {
            width: 50px;
            height: 50px;
            object-fit: contain;
        }

        /* 중간 - 인보이스 내용 영역 */
        .invoice-letter-content {
            position: absolute;
            left: 0;
            right: 0;
            background: white;
            transition: all 700ms ease-out;
            bottom: var(--envelope-body-height);
            height: 0px;
            opacity: 0;
            border-left: 1px solid rgba(224, 224, 224, 0.5);
            border-right: 1px solid rgba(224, 224, 224, 0.5);
            z-index: 15;
            overflow: hidden;
            cursor: pointer; /* 편지가 열렸을 때 클릭 가능하도록 */
        }

        .invoice-letter-card:hover .invoice-letter-content {
            height: var(--letter-content-height);
            opacity: 1;
        }

        .invoice-letter-content-inner {
            padding: 40px 64px;
            transition: all 700ms;
            opacity: 0;
            transform: translateY(20px);
        }

        .invoice-letter-card:hover .invoice-letter-content-inner {
            opacity: 1;
            transform: translateY(0);
        }

        .invoice-letter-content-grid {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .invoice-letter-content-left {
            flex: 1;
        }

        .invoice-letter-content-left .invoice-title {
            font-family: 'Paperlogy', 'Georgia', serif;
            font-weight: 500;
            font-size: 10.891px;
            font-style: normal;
            color: #000;
            line-height: calc(10.891px * 1.2); /* font-size × 1.2 */
            letter-spacing: 1.089px;
            margin-bottom: 16px;
            white-space: nowrap;
        }

        .invoice-letter-content-left .invoice-meta {
            font-family: 'Paperlogy', 'Georgia', serif;
            font-weight: 500;
            font-size: 10.891px;
            font-style: normal;
            color: #000;
            line-height: calc(10.891px * 1.5); /* font-size × 1.5 */
            letter-spacing: 1.089px;
            margin-bottom: 8px;
            white-space: nowrap;
        }

        /* INVOICE NO의 "IN" 부분만 다른 크기 */
        .invoice-letter-content-left .invoice-meta .invoice-no-label {
            font-size: 10.891px;
            letter-spacing: 1.0891px;
        }

        .invoice-letter-content-left .invoice-meta .invoice-no-value {
            font-size: 10.821px;
            letter-spacing: 1.0821px;
        }

        /* ISSUE DATE의 "ISSU" 부분만 다른 크기 */
        .invoice-letter-content-left .invoice-meta .issue-date-label {
            font-size: 10.891px;
            letter-spacing: 1.0891px;
        }

        .invoice-letter-content-left .invoice-meta .issue-date-value {
            font-size: 10.821px;
            letter-spacing: 1.0821px;
        }

        .invoice-letter-content-right {
            text-align: right;
        }

        .invoice-content-brand-logo {
            max-width: 120px;
            max-height: 60px;
            width: auto;
            height: auto;
            object-fit: contain;
        }

        /* 카드 밑 정보 영역 */
        .invoice-card-info-footer {
            margin-top: 32px;
            padding: 24px;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            width: var(--card-width);
            text-align: left;
        }

        /* Figma 스타일 적용 */
        .invoice-card-info-footer .product-info,
        .invoice-card-info-footer .status {
            font-family: 'Paperlogy', 'Georgia', serif;
            font-size: 12.5px;
            font-style: normal;
            font-weight: 600;
            line-height: calc(14px * 1.4); /* font-size × 1.4 */
            letter-spacing: 2px;
            color: #808080;
            margin: 0 0 20px 0; /* 모든 margin 명시적으로 통일 */
            padding: 0;
            white-space: nowrap;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* 레이블 (PRODUCT NAME, DATE, STATUS) - 공통 스타일, 시작 위치 통일 */
        .invoice-card-info-footer .info-label,
        .invoice-card-info-footer .status-label {
            font-weight: 600;
            color: #808080;
            flex-shrink: 0;
            min-width: 0;
            text-align: left;
        }

        /* 값 (제품명, 날짜, 상태) - 공통 스타일 */
        .invoice-card-info-footer .info-value,
        .invoice-card-info-footer .status-value {
            font-weight: 600;
            color: #808080;
        }

        /* 값 우측 정렬 (info-value만) */
        .invoice-card-info-footer .info-value {
            text-align: right;
        }

        /* STATUS 전용 스타일 */
        .invoice-card-info-footer .status:last-child {
            margin-bottom: 0;
        }

        .invoice-card-info-footer .status-value-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
            /* justify-content: space-between이 이미 처리함 */
        }

        .invoice-card-info-footer .status.verified .status-value {
            color: #0c3008;
        }

        /* 아이콘 공통 스타일 */
        .invoice-check-icon,
        .invoice-warning-icon {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
            display: none;
        }

        /* 상태별 아이콘 표시 */
        .invoice-card-info-footer .status.verified .invoice-check-icon {
            display: inline-block;
        }

        .invoice-card-info-footer .status.invalid .invoice-warning-icon {
            display: inline-block;
        }

        /* 상태별 텍스트 색상 */
        .invoice-card-info-footer .status.verified .status-value {
            color: #0c3008;
        }

        .invoice-card-info-footer .status.invalid .status-value {
            color: #310809;
        }

        /* 상단 뚜껑 */
        .invoice-envelope-flap {
            position: absolute;
            left: 0;
            right: 0;
            bottom: var(--envelope-body-height);
            height: var(--envelope-flap-height);
            background-color: rgba(230, 230, 230, 1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-bottom: 2px solid #E0E0E0;
            border: 1px solid rgba(255, 255, 255, 0.5);
            z-index: 20;
            transition: all 700ms ease-out;
        }

        .invoice-letter-card:hover .invoice-envelope-flap {
            bottom: calc(var(--envelope-body-height) + var(--envelope-flap-height) + var(--hover-lift-distance));
            box-shadow: 0 -8px 20px rgba(0, 0, 0, 0.25);
        }

        /* ============================================
           인보이스 그리드 레이아웃
           (편지 카드들을 담는 컨테이너)
           ============================================ */
        .invoice-grid {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
        }
    </style>
    <script defer src="/utils.js"></script>
    <script defer src="/header-loader.js"></script>
    <script defer src="/header-scroll.js"></script>
    <script defer src="/footer-loader.js"></script>
    <script defer src="/digital-invoice.js"></script>
</head>
<body>
    <!-- 헤더 컨테이너 -->
    <div id="header-container"></div>

    <!-- 메인 컨텐츠 -->
    <main class="my-warranties-main">
        <!-- 로고 섹션 -->
        <div class="logo-section">
            <img src="/image/prepmoodlogo.jpg" alt="Pre.p Mood" class="main-logo">
        </div>

        <!-- 메인 레이아웃 -->
        <div class="main-layout">
            <!-- 좌측 사이드바 -->
            <aside class="sidebar">
                <div class="sidebar-content">
                    <!-- 사용자 환영 메시지 -->
                    <div class="user-welcome">
                        <h2 id="user-welcome-text">님 환영합니다.</h2>
                    </div>

                    <!-- 네비게이션 메뉴 -->
                    <nav class="sidebar-nav">
                        <a href="/my-orders.html" class="nav-item" data-page="orders">
                            <span>내 주문</span>
                            <div class="nav-underline"></div>
                        </a>
                        <a href="/my-reservations.html" class="nav-item" data-page="reservations">
                            <span>예약</span>
                            <div class="nav-underline"></div>
                        </a>
                        <a href="/digital-invoice.html" class="nav-item active" data-page="invoice">
                            <span>디지털 인보이스</span>
                            <div class="nav-underline"></div>
                        </a>
                        <a href="/digital-warranty.html" class="nav-item" data-page="warranty">
                            <span>디지털 보증서</span>
                            <div class="nav-underline"></div>
                        </a>
                        <a href="/my-profile.html" class="nav-item" data-page="profile">
                            <span>내 프로필</span>
                            <div class="nav-underline"></div>
                        </a>
                    </nav>
                </div>
            </aside>

            <!-- 우측 메인 영역 -->
            <section class="main-content">
                <div class="content-container">
                    <!-- 페이지 제목 -->
                    <div class="page-header">
                        <h1 class="page-title">디지털 인보이스</h1>
                        <p class="page-subtitle">발급받은 디지털 인보이스 목록</p>
                        <p class="page-english">Digital Invoice</p>
                    </div>

                    <!-- 인보이스 그리드 영역 -->
                    <section class="invoice-grid" id="invoiceGrid">
                        <!-- JavaScript로 동적 생성 -->
                    </section>

                    <!-- 인보이스 목록이 없는 경우 -->
                    <div id="no-invoices" class="no-warranties" style="display: none;">
                        <div class="no-warranties-content">
                            <h2 class="no-warranties-title">발급받은 인보이스가 없습니다.</h2>
                            <p class="no-warranties-subtitle">구매 내역에서 인보이스를 확인하세요.</p>
                        </div>
                    </div>

                    <!-- 로딩 상태 -->
                    <div id="loading-invoices" class="loading-warranties" style="display: none;">
                        <p>인보이스 목록을 불러오는 중...</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- 푸터 컨테이너 -->
    <div id="footer-container"></div>
</body>
</html>
